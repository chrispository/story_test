{"version":3,"sources":["turbopack:///[project]/story_test/ai-cyoa/src/app/admin/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState } from 'react';\n\ntype Settings = {\n  gemini_model: string;\n  gemini_temperature: number;\n  gemini_top_p: number;\n  gemini_top_k: number;\n  system_prompt: string;\n  story_prompt_template: string;\n  image_prompt_template: string;\n  image_model: string;\n};\n\nexport default function Admin() {\n  const [s, setS] = useState<Settings | null>(null);\n  const [saving, setSaving] = useState(false);\n  const [unauth, setUnauth] = useState(false);\n\n  async function load() {\n    const res = await fetch('/api/admin/settings');\n    if (res.status === 401) { setUnauth(true); return; }\n    const json = await res.json();\n    setS(json);\n  }\n\n  useEffect(() => { load(); }, []);\n\n  if (unauth) {\n    return (\n      <div className=\"px-4 sm:px-6 py-10 text-center\">\n        <div className=\"opacity-70\">Unauthorized. Please <a href=\"/admin/login\" className=\"underline\">log in</a>.</div>\n      </div>\n    );\n  }\n\n  if (!s) return <div className=\"px-4 sm:px-6 py-10 text-center opacity-70\">Loading…</div>;\n\n  async function save(patch: Partial<Settings>) {\n    const next = { ...(s as Settings), ...patch } as Settings;\n    setS(next);\n    setSaving(true);\n    const res = await fetch('/api/admin/settings', { method: 'PUT', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(next) });\n    setSaving(false);\n    if (!res.ok) alert('Failed to save');\n  }\n\n  return (\n    <div className=\"px-4 sm:px-6 py-8 max-w-5xl mx-auto grid gap-6\">\n      <div className=\"text-lg font-medium\">Admin Settings</div>\n      <section className=\"grid gap-2 rounded-2xl p-5 bg-white/80 dark:bg-white/5 backdrop-blur border border-black/5 dark:border-white/10\">\n        <div className=\"font-medium\">Models</div>\n        <div className=\"grid sm:grid-cols-2 gap-3\">\n          <LabeledInput label=\"Gemini Model\" value={s.gemini_model} onChange={(v) => save({ gemini_model: v })} />\n          <LabeledInput label=\"Imagen Model\" value={s.image_model} onChange={(v) => save({ image_model: v })} />\n        </div>\n      </section>\n\n      <section className=\"grid gap-2 rounded-2xl p-5 bg-white/80 dark:bg-white/5 backdrop-blur border border-black/5 dark:border-white/10\">\n        <div className=\"font-medium\">Parameters</div>\n        <div className=\"grid sm:grid-cols-3 gap-3\">\n          <LabeledInput label=\"Temperature\" type=\"number\" step=\"0.1\" value={s.gemini_temperature} onChange={(v) => save({ gemini_temperature: Number(v) })} />\n          <LabeledInput label=\"Top P\" type=\"number\" step=\"0.05\" value={s.gemini_top_p} onChange={(v) => save({ gemini_top_p: Number(v) })} />\n          <LabeledInput label=\"Top K\" type=\"number\" step=\"1\" value={s.gemini_top_k} onChange={(v) => save({ gemini_top_k: Number(v) })} />\n        </div>\n      </section>\n\n      <section className=\"grid gap-3 rounded-2xl p-5 bg-white/80 dark:bg-white/5 backdrop-blur border border-black/5 dark:border-white/10\">\n        <div className=\"font-medium\">System Prompt</div>\n        <Textarea value={s.system_prompt} onChange={(v) => save({ system_prompt: v })} rows={3} />\n      </section>\n\n      <section className=\"grid gap-3 rounded-2xl p-5 bg-white/80 dark:bg-white/5 backdrop-blur border border-black/5 dark:border-white/10\">\n        <div className=\"font-medium\">Story Prompt Template</div>\n        <div className=\"text-xs opacity-60\">Available: <code>{\"{{genre}}\"}</code>, <code>{\"{{history}}\"}</code>, <code>{\"{{choice}}\"}</code></div>\n        <Textarea value={s.story_prompt_template} onChange={(v) => save({ story_prompt_template: v })} rows={6} />\n      </section>\n\n      <section className=\"grid gap-3 rounded-2xl p-5 bg-white/80 dark:bg-white/5 backdrop-blur border border-black/5 dark:border-white/10\">\n        <div className=\"font-medium\">Image Prompt Template</div>\n        <div className=\"text-xs opacity-60\">Available: <code>{\"{{genre}}\"}</code>, <code>{\"{{scene_summary}}\"}</code></div>\n        <Textarea value={s.image_prompt_template} onChange={(v) => save({ image_prompt_template: v })} rows={4} />\n      </section>\n\n      {saving && <div className=\"fixed bottom-4 right-4 text-xs py-1.5 px-2.5 rounded-lg bg-black/70 text-white\">Saving…</div>}\n    </div>\n  );\n}\n\nfunction LabeledInput({ label, value, onChange, type = 'text', step }: { label: string; value: any; onChange: (v: string) => void; type?: string; step?: string }) {\n  return (\n    <label className=\"grid gap-1\">\n      <span className=\"text-xs opacity-60\">{label}</span>\n      <input\n        type={type}\n        step={step}\n        value={value}\n        onChange={(e) => onChange(e.target.value)}\n        className=\"rounded-lg px-3 py-2 bg-white/60 dark:bg-black/30 border border-black/10 dark:border-white/10 focus:outline-none focus:ring-2 focus:ring-cyan-400/60\"\n      />\n    </label>\n  );\n}\n\nfunction Textarea({ value, onChange, rows = 4 }: { value: string; onChange: (v: string) => void; rows?: number }) {\n  return (\n    <textarea\n      value={value}\n      onChange={(e) => onChange(e.target.value)}\n      rows={rows}\n      className=\"rounded-lg px-3 py-2 bg-white/60 dark:bg-black/30 border border-black/10 dark:border-white/10 focus:outline-none focus:ring-2 focus:ring-cyan-400/60\"\n    />\n  );\n}\n"],"names":[],"mappings":"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"}